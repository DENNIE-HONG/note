## 1. å‡½æ•°
### new æ“ä½œç¬¦å…·ä½“å¹²äº†ä»€ä¹ˆäº‹æƒ…ï¼Ÿ
1. åˆ›å»ºäº†ä¸€ä¸ªç©ºå¯¹è±¡ var obj = new Object();
2. è®¾ç½®åŸå‹é“¾ obj._proto = Func.prototype;
3. è®©Funcä¸­çš„thisæŒ‡å‘obj,å¹¶æ‰§è¡ŒFuncå‡½æ•°ä½“ï¼›
4. åˆ¤æ–­Funcè¿”å›å€¼ç±»å‹ï¼›
```js
function new (func) {
  let o = object.create(func.prototype);
  let k = func.call(o);
  return typeof k === 'object' ? k: o;
}
```

### bindçš„æ¨¡æ‹Ÿå®ç°ï¼Ÿ
bind()æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ï¼Œå½“è¿™ä¸ªæ–°å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œbind()çš„ç¬¬ä¸€ä¸ªå‚æ•°å°†ä½œä¸ºå®ƒè¿è¡Œæ—¶çš„thisã€‚ä¹‹åçš„å‚æ•°ä¼šåœ¨ä¼ é€’å®å‚å‰ä¼ å…¥ä½œä¸ºå®ƒçš„å‚æ•°ã€‚
```js
Function.prototype.bind = function(context) {
  var self = this;
  var args = Array.prototype.slice.call(arguments, 1);
  return function() {
    var bindArgs = Array.prototype.slice.call(arguments);
    self.apply(context, args.concat(bindArgs));
  }
}
```
é—®é¢˜ï¼š  
ä¸€ä¸ªç»‘å®šå‡½æ•°ä¹Ÿèƒ½ä½¿ç”¨new æ“ä½œç¬¦åˆ›å»ºå¯¹è±¡ï¼Œè¿™ç§è¡Œä¸ºå°±åƒæŠŠåŸå‡½æ•°å½“æˆæ„é€ å™¨ã€‚æä¾›çš„thiså€¼è¢«å¿½ç•¥ï¼ŒåŒæ—¶è°ƒç”¨æ—¶çš„å‚æ•°è¢«æä¾›ç»™å‡½æ•°ã€‚  
bindæ”¹è¿›ï¼š
```js
Function.prototype.bind = function(context) {
  if (typeof this !== 'function') {
    throw Error('è°ƒç”¨ä¸äº†');
  }
  var self = this;
  var args = Array.prototype.slice.call(arguments, 1);
  var fNop = function () {};
  var fbound = function () {
    // å½“ä½œæ„é€ å‡½æ•°ï¼ŒthisæŒ‡å‘å®ä¾‹ï¼ŒselfæŒ‡å‘
    // ç»‘å®šå‡½æ•°ï¼Œå½“æ™®é€šå‡½æ•°ï¼ŒthisæŒ‡å‘window
    self.apply(this.instanceof self ? this: context, args.concat(Array.prototype.slice.call(arguments)));
  }
  fNop.prototype = this.prototype;
  // ä¿®æ”¹fbound.prototypeæ—¶å€™ï¼Œä¸æƒ³ä¿®æ”¹ç»‘å®šå‡½æ•°
  //çš„prototype
  fbound.prototype = new fNop();
  return fbound;
}
```

### é—­åŒ…
æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡çš„å‡½æ•°ã€‚

### å‡½æ•°å‚æ•°
å‚æ•°ä¼ é€’ï¼š  
å‚æ•°æ˜¯åŸºæœ¬ç±»å‹æ˜¯æŒ‰å€¼ä¼ é€’ï¼Œå¼•ç”¨ç±»å‹æŒ‰å…±äº«ä¼ é€’

### é˜²æŠ–debounce
åŸç†ï¼š
ä¸€å®šåœ¨äº‹ä»¶è§¦å‘Nç§’åæ‰æ‰§è¡Œï¼Œå¦‚æœåœ¨ä¸€ä¸ªäº‹ä»¶è§¦å‘çš„nç§’å†…åˆè§¦å‘äº†ï¼Œä»¥æ–°çš„æ—¶é—´ä¸ºå‡†ã€‚ç­‰ä½ è§¦å‘å®Œäº‹ä»¶nç§’å†…ä¸å†è§¦å‘ï¼Œæ‰æ‰§è¡Œã€‚   
ä¾‹å¦‚ï¼šresizeã€scrolläº‹ä»¶
```js
function debounce(fn, delay, immediate) {
  let timer = null;
  let result;
  return function() {
    const context = this;
    const args = arguments;
    if (timer) {
      clearTimeout(timer);
    }
    if (immediate) {
      // å¦‚æœå·²æ‰§è¡Œè¿‡ï¼Œä¸å†æ‰§è¡Œ
      const doNow = !timer;
      timer = setTimeout((function() {
        timer = null;
      }, delay);
      if (doNow) {
        result = func.apply(context, args);
      }
    } else {
      timer = setTimeout(function() {
        func.apply(constext, args);
      }, delay);
    }
    return result;
  }
}
``` 


### èŠ‚æµthrottle
åŸç†ï¼šæŒç»­è§¦å‘äº‹ä»¶ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼Œåªæ‰§è¡Œä¸€æ¬¡äº‹ä»¶ã€‚  
ä¾‹å¦‚ï¼šè¾“å…¥æ¡†çš„è”æƒ³
ç”¨setTimeoutå»¶è¿Ÿï¼Œè¿˜æ²¡å®Œæˆå°±å¿½ç•¥è¯·æ±‚ã€‚
```js
// å®šæ—¶å™¨å®ç°ï¼Œ
let throttle = function(func, delay) {
  let timer = null;
  return function() {
    const context = this;
    const args = arguments;
    if (!timer) {
      timer = setTimeout(function() {
        func.apply(context, args);
        timer = null;
      }, delay);
    }
  }
}
// äº‹ä»¶æˆ³å®ç°ï¼Œäº‹ä»¶ä¼šç«‹å³æ‰§è¡Œï¼Œåœæ­¢è§¦å‘åä¸å†æ‰§è¡Œ
let throttle = function(fn, delay) {
 let prev = 0;
 return function() {
   const context = this;
   const args = arguments;
   const now = Date.now();
   if (now - prev >= delay) {
     func.apply(context, args);
     prev = now;
   }
 }
};

```

### åå‡½æ•°
å›ºå®šä¸€ä¸ªå‡½æ•°çš„ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œå°†ä¸€ä¸ªnå…ƒå‡½æ•° => n-xå…ƒå‡½æ•°
```js
// å ä½ç¬¦
var _ = {};
function partial(fn) {
  var args = [].slice.call(arguments, 1);
  return function() {
    var posiion = 0;
    var len = args.length;
    for (var i = 0; i < len; i++) {
      args[i] = args[i] === _? arguments[position++]: args[i];

    }
    while (position < arguments.length) {
      args.push(arguments[position++]);
    }
    return fn.apply(this, args);
  }
}

var subtract = function(a, b) {
  return b-a;
}
subForm20 = partial(subract, _, 20);
subForm(5); // 15
```
### å‡½æ•°ç»„åˆ
åŸç†ï¼šå°†å¤šä¸ªå‡½æ•°ç»„åˆä¸€èµ·ï¼Œä»å³å‘å·¦æ‰§è¡Œã€‚  
ä½œç”¨ï¼šåˆ©ç”¨æŸ¯é‡ŒåŒ–å’Œcomposeå®ç°pointfreeã€‚
ä¸ä½¿ç”¨æ‰€è¦å¤„ç†çš„å€¼ï¼Œåªåˆæˆè¿ç®—ã€‚ä¸Šå±‚è¿ç®—ä¸ç›´æ¥æ“ä½œæ•°æ®ï¼Œé€šè¿‡åº•å±‚å»å¤„ç†ã€‚

```js
function compose() {
  let args = arguments;
  const start = args.length - 1;
  return function() {
    let i = start;
    let result = args[start].apply(this, arguments);
    while(i--) {
      result = args[i].call(this, result);
    }
    return result;
  }
}
```

### å°¾è°ƒç”¨ä¼˜åŒ–TCO
å‡å°‘è°ƒç”¨æ ˆå¸§ï¼Œå¼•æ“ä¸ç”¨é™åˆ¶æ ˆæ·±åº¦ã€‚
ä¾‹å­ï¼šé€’å½’
```js
function factoria(n) {
  function fact(n, res) {
    if (n < 2) {
      return res;
    }
    return fact(n-1, n * res);
  }
  return fact(n, 1);
}
```



## 2. å¯¹è±¡
å³ä½¿åœ¨å‡½æ•°å†…éƒ¨ä¿®æ”¹å‚æ•°çš„å€¼ï¼ŒåŸå§‹å¼•ç”¨ä¿æŒæœªå˜.å±€éƒ¨å¯¹è±¡ç«‹å³è¢«é”€æ¯ã€‚
```js
function setName(obj) {
  obj.name = "Nicholas";
  obj = new Object();
  obj.name = "Greg";
}
var person = new Object();
setName(person);
alert(person.name); // Nicholas
```






## 3. ç»§æ‰¿
jsä¸­æ ¹å¯¹è±¡æ˜¯Object.prototype,æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯ä»Object.prototypeå…‹éš†æ¥çš„ã€‚  
```js
var obj = new Object(); // åŸå‹ => Object.prototype

```
ä»¥ä¸‹3ç§ç»§æ‰¿æ–¹æ³•ä¸ä¼˜ç¼ºç‚¹ï¼Ÿ
```js
function Shape() {}
function Rect() {}
```
### æ–¹æ³•1
```js
Rect.prototype = new Shape();
```
ä¼˜ç‚¹ï¼š
* æ­£ç¡®è®¾ç½®åŸå‹é“¾å®ç°ç»§æ‰¿ï¼›
* çˆ¶ç±»å®ä¾‹å±æ€§å¾—åˆ°ç»§æ‰¿ï¼ŒåŸå‹é“¾æŸ¥æ‰¾æ•ˆç‡é«˜ï¼›  

ç¼ºç‚¹ï¼š
* çˆ¶ç±»å®ä¾‹å±æ€§ä¸º**å¼•ç”¨ç±»å‹**æ—¶å€™ï¼Œä¸æ°å½“ä¿®æ”¹ä¼šå¯¼è‡´æ‰€æœ‰å­ç±»ä¿®æ”¹ï¼›
* æ— æ³•ç¡®å®šæ„é€ å‡½æ•°éœ€è¦çš„åˆç†å‚æ•°ï¼›

### æ–¹æ³•2
```js
Rect.prototype = Shape.prototype;
```
ç¼ºç‚¹ï¼šä¿®æ”¹å­ç±»åŸå‹ï¼Œæ·»åŠ æ–¹æ³•ä¼šä¿®æ”¹çˆ¶ç±»
### æ–¹æ³•3
```js
Rect.prototype = Object.create(Shape.prototype);
Rect.prototype.area = function() {
  // do something
}
```
é¿å…äº†1.2ä¸­çš„ç¼ºç‚¹

### ä¸ºä»€ä¹ˆç”¨Object.create(null)æ¥åˆ›å»ºå¯¹è±¡ï¼Ÿè€Œä¸ç”¨{}
å› ä¸º{}ä¼šç»§æ‰¿ObjectåŸå‹é“¾ä¸Šæ‰€æœ‰æ–¹æ³•ã€‚è€ŒåŸå‹æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œä¾‹å¦‚åˆ«çš„åº“orå¼€å‘è€…ä¿®æ”¹äº†ObjectåŸå‹ï¼Œ{}ä¹Ÿä¼šç»§æ‰¿ä¿®æ”¹åçš„æ–¹æ³•ã€‚

## 4. this
### ç”¨ECMAScriptè§„èŒƒè§£è¯»this  ï¼ˆè¾ƒéš¾ï¼‰
å‰æï¼šä»€ä¹ˆæ˜¯Reference?  
* ç”¨æ¥è§£é‡Šè¯¸å¦‚delete/typeof ä»¥åŠèµ‹å€¼ç­‰æ“ä½œè¡Œä¸ºçš„ã€‚Reference Typeæœ¬èº«æ˜¯ä¸€ä¸ªä¸‰ä¸ªå€¼çš„ç»„åˆ(base,name,strict)  

MemberExpression?    
ä¸€èˆ¬æ˜¯()çš„å·¦è¾¹

1. è®¡ç®—MemberExpressionèµ‹ç»™ref
2. åˆ¤æ–­refæ˜¯ä¸æ˜¯Reference?  
    * æ˜¯ï¼Œthis = GetBase(ref);  
    * æ˜¯ï¼Œbase valueæ˜¯Environment Record, this => undefiend  
    * ä¸æ˜¯ï¼Œthis => undefined

æ —å­
```js
var value = 1;
var foo = {
  value: 2,
  bar: function() {
    return this.value;
  }
}
```
1. console.log(foo.bar()): 
```js
ref = MemberExpression() = foo.bar
// æ˜¯Reference
Reference = {
  base: foo,
  name: 'bar',
  strict: false
}
// this = GetBase(ref)
// this = foo
// ç­”æ¡ˆæ˜¯2
```

2. console.log((foo.bar)())  
()å¹¶æ²¡æœ‰å¯¹MemberExpressionè®¡ç®—ï¼Œç»“æœä¸ä¸Šé¢ä¸€æ ·

3. console.log((foo.bar = foo.bar)());  
èµ‹å€¼æ“ä½œç¬¦=ï¼Œè¿”å›ä¸æ˜¯Reference.
this = undefined, ç­”æ¡ˆæ˜¯1
4. console.log((false || foo.bar)());  
é€»è¾‘ä¸è¿ç®—ï¼Œä¸æ˜¯Referenceç±»å‹ï¼Œthis = undefined
5. console.log((foo.bar, foo.bar)());  
é€—å·è¿ç®—ç¬¦ï¼Œè¿”å›ä¸æ˜¯Referenceç±»å‹ï¼Œthis = undefined

### thisç»‘å®š
æ˜¾æ€§ã€éšå½¢ã€ç¡¬ç»‘å®šã€newç»‘å®šã€é»˜è®¤ç»‘å®š
ç»‘å®šä¼˜å…ˆçº§ï¼šnewç»‘å®š > ç¡¬ç»‘å®šoræ˜¾ç¤º > éšå¼ > é»˜è®¤  
æ›´å®‰å…¨çš„thisï¼š è°ƒç”¨æ—¶æ ¹æœ¬ä¸åœ¨ä¹thisæŒ‡å‘è°æ—¶ï¼Œå¯ç”¨
```js
const a = Objact.create(null);
foo.apply(a, [2, 3]);
```

## 5. æ“ä½œç¬¦
### 5.1 ~X
~X ç­‰åŒäº -(x+1)
```js
~42; // -43
```
-1 æ˜¯ä¸€ä¸ª"å“¨ä½å€¼"ï¼ŒindexOf(...)æ‰¾ä¸åˆ°å­—ç¬¦ä¸²æ‰€åœ¨ä½ç½®ï¼Œè¿”å›-1.
ä¾‹å¦‚ï¼š  
```js
const a = "Hello World";
if (a.indexOf("ol") === -1) {
  // æ²¡æœ‰åŒ¹é…åˆ°ï¼ŒæŠ½è±¡æ¸—æ¼ï¼Œæš´éœ²äº†åº•å±‚å®ç°ç»†èŠ‚
}

if (!~a.indexOf("ol")) {
  console.log("æ²¡æœ‰åŒ¹é…åˆ°");
}
```

### 5.2 éšå¼è½¬æ¢
#### 5.2.1 éšå¼è½¬æ¢ä¸ºå¸ƒå°”
* if ()
* for(..;...;...)
* while(...)å’Œdo...while(...)
* ?:
* ||å’Œ&&

#### 5.2.2 x == y
==ï¼šå…è®¸å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œä¼šå‡ºå¾ˆå¤šæ„æƒ³ä¸åˆ°çš„é—®é¢˜ã€‚  
##### æƒ…å†µ1ï¼š
1. xå¸ƒå°”ï¼Œè¿”å›ToNumber(x) == y
2. yå¸ƒå°”ï¼Œè¿”å›x == ToNumber(y)
å“ªä¸ªæ˜¯å¸ƒå°”ï¼Œå…ˆè½¬ä¸ºæ•°å­—ã€‚
```js
const x = "42";
const y = true;
console.log(x == y); // false
```
**å°½é‡ä¸è¦ä½¿ç”¨ == trueå’Œ == falseæƒ…å†µ**
ä¸¾ä¸ªğŸŒ°ï¼š
```js
const a = "42";
if (a == true) {} // false
if (a === true){} // false
if (a) {} // true
if (!aa) {} // æ›´å¥½ï¼ï¼ï¼
if(Boolean(a)) {} // true

```

```js
false == 0; => 0 == 0; // true
false === ""; => 0 == "" ; => 0 == 0; // true
false == []; => false == ""; => 0 == ""; => 0 == 0; // true
```
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

##### æƒ…å†µ2ï¼š
1. x nullï¼Œy = undefiend, true
2. x = undefiend, y = null, true
```js
let a = null;
let b;
console.log(a == b); // true
console.log(a == null); // true
console.log(b == null); // true

let a = doSomething(); // è¿”å›null or undefiend
if (a == null) {} // true
```
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
##### æƒ…å†µ3ï¼š
x == y ? (å¯¹è±¡ vs æ•°å­—orå­—ç¬¦ä¸²)ï¼šå“ªä¸ªæ˜¯å¯¹è±¡ï¼Œå¯¹è±¡å…ˆè½¬æˆ**å­—ç¬¦ä¸²**ï¼Œå†å¯¹æ¯”
```js
const a = "abc";
const b = Object(a);
console.log(a == b); // true
```

```js
const a = null;
const b = Object(a);
console.log(a == b); // false
```
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
##### æƒ…å†µ4ï¼š
1. xæ•°å­—ï¼Œyå­—ç¬¦ä¸²ï¼Œx == ToNumber(y);
2. xå­—ç¬¦ä¸²ï¼Œyæ•°å­—ï¼ŒToNumber(x) == y;
å“ªä¸ªæ˜¯å­—ç¬¦ä¸²ï¼Œè½¬ä¸ºæ•°å­—å†å¯¹æ¯”ï¼›

```js
"0" == false; è½¬ "0" == 0; è½¬ 0 == 0; // true,å¸ƒå°”å…ˆè½¬æ•°å­—
"" == []; è½¬ "" == ""; // true, å¯¹è±¡å…ˆè½¬å­—ç¬¦ä¸²
0 == []; è½¬ 0 == ""; è½¬ 0 == 0; // true
```
æ³¨æ„ï¼š**==â€œâ€ã€==0**
ä¸¾ä¸ªä¾‹å­ï¼š
```js
function doSomething(a) {
  if (a == "") {...} // æ”¹ç”¨a === ""
}
doSomething(0);
doSomething([]); // éƒ½ä¼šæ‰§è¡Œ
```

#### 5.2.3 a < b å…³ç³»æ¯”è¾ƒ
å…³ç³»æ¯”è¾ƒæ—¶å€™ï¼Œå…ˆè¿›è¡Œæ˜¾å¼å¼ºåˆ¶ç±»å‹è½¬æ¢
ä¸¾ä¸ªä¾‹å­ï¼š
```js
const a = { b: 42};
const b = {b: 43};
console.log(a < b); //false
console.log(a == b); // false
console.log(a > b); // false
console.log(a <= b); // true
console.log(a >= b); // true
a <= b;   è½¬æˆ  !(b < a); å¾—åˆ° true
```

#### 5.2.4 x + y
å‘æ¥äº†ï¼š
```js
[] + {}; // ["object Object"]
{} + []; // 0
```
+å­—ç¬¦ä¸²å˜æ•°å­—
```js
[] + {}; è½¬ "" + "[object Object]"; => ["object Object"];
{} + []; è½¬ +[] ; => + "" => 0; // ç©ºä»£ç å—ï¼Œä¸ä½œä»»ä½•æ“ä½œ
```

## 5.3 ?:å’Œ =
éƒ½æ˜¯å³å…³è”çš„ã€‚
```js
a ? b : c ? d: e;    =>    a ? b : (c ? d: e);
```
```js
a = b = c = 42;  =>   a = (b = (c = 42));
```
